<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>BelgeDedektif</title>
    <style>
        body { font-family: Arial, sans-serif; padding: 30px; }
        #sonuc { margin-top: 24px; background: #fafafa; border: 1px solid #eee; padding: 16px; border-radius: 7px; }
        .link { margin-top: 8px; display: block; }
        h1 { color: #222; }
        input, button { font-size: 16px; }
    </style>
</head>
<body>
    <h1>BelgeDedektif’e Hoşgeldiniz!</h1>
    <form id="yukleForm">
        <input type="file" id="dosya" name="files" multiple accept=".pdf,.docx,.txt,.jpg,.jpeg,.png" />
        <button type="submit">Yükle & Analiz Et</button>
    </form>
    <div id="sonuc"></div>

    <script>
        document.getElementById('yukleForm').onsubmit = async function(e) {
            e.preventDefault();
            let formData = new FormData();
            let files = document.getElementById('dosya').files;
            for(let i=0; i<files.length; i++) formData.append('files', files[i]);
            let sonuc = document.getElementById('sonuc');
            sonuc.innerHTML = 'Yükleniyor...';
            let res = await fetch('/upload-analyze', {method: 'POST', body: formData});
            if(res.ok) {
                let json = await res.json();
                let html = `<b>${json.message}</b>`;
                json.results.forEach(item => {
                    html += `<hr>
                    <b>Dosya:</b> ${item.filename}<br>
                    <b>Tür:</b> ${item.file_type}<br>
                    <b>Boyut:</b> ${(item.file_size/1024).toFixed(1)} KB<br>
                    <b>Azure Link:</b> <a href="${item.blob_url}" target="_blank" class="link">Dosyayı Görüntüle</a>
                    <b>Çıkarılan Metin:</b><br>
                    <pre style="white-space:pre-wrap;">${item.extracted_text}</pre>
                    <b>Metin Uzunluğu:</b> ${item.text_length}`;
                });
                sonuc.innerHTML = html;
            } else {
                sonuc.textContent = 'Hata: ' + res.statusText;
            }
        }
    </script>
</body>
</html>
